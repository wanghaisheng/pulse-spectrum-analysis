要通过谐波拟合建立提取特征参数的数学模型，并应用多周期整体最小二乘法，我们可以使用傅里叶级数的多周期扩展。这种方法允许我们同时考虑多个周期长度的信号，并通过最小化误差来找到最佳拟合的参数。

### 多周期整体最小二乘法

在多周期整体最小二乘法中，我们考虑多个周期长度 \( T_i \) 的信号，并使用这些周期长度的傅里叶级数来拟合原始信号。目标是最小化原始信号与拟合信号之间的总误差。

### 实现步骤

1. **信号预处理**：对原始信号进行去噪和归一化处理。
2. **定义多周期模型**：为每个周期长度 \( T_i \) 定义一个傅里叶级数模型。
3. **整体最小二乘拟合**：使用整体最小二乘法来找到最佳拟合参数。
4. **特征提取**：从拟合参数中提取特征参数，如振幅、频率和相位。

### Python代码示例

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import least_squares

# 示例信号
t = np.linspace(0, 10, 1000)   # 时间点
f = np.sin(2 * np.pi * 5 * t) + 0.5 * np.sin(2 * np.pi * 10 * t)   # 示例信号，包含两个谐波

# 定义多周期模型函数
def model(t, params):
    a = params[:len(params)//2]
    b = params[len(params)//2:]
    T = params[-1]
    return np.sum([a[i] * np.sin(2 * np.pi * i * t / T) + b[i] * np.cos(2 * np.pi * i * t / T) for i in range(1, len(a)+1)], axis=0)

# 定义误差函数
def error(params, t, y):
    return model(t, params) - y

# 初始参数
initial_params = np.concatenate([np.zeros(2), np.zeros(2), [10]])   # a, b, T

# 最小化误差
result = least_squares(error, initial_params, args=(t, f))

# 提取拟合参数
a_fit = result.x[:len(result.x)//2]
b_fit = result.x[len(result.x)//2:-1]
T_fit = result.x[-1]

# 使用拟合参数构造脉图
t_fit = np.linspace(0, 10, 1000)
y_fit = model(t_fit, result.x)

# 绘制结果
plt.figure(figsize=(12, 6))
plt.subplot(1, 2, 1)
plt.plot(t, f, label='Original Signal')
plt.plot(t_fit, y_fit, label='Fitted Signal')
plt.legend()
plt.title('Fitting Result')

plt.subplot(1, 2, 2)
plt.plot(t_fit, y_fit, label='Fitted Signal')
plt.title('Fitted Pulse Diagram')
plt.show()
```

这段代码首先定义了一个多周期模型函数和一个误差函数，然后使用`scipy.optimize.least_squares`函数来找到最佳拟合参数。最后，使用这些参数来构造脉图，并绘制原始信号和拟合信号的图形。

请注意，这只是一个简化的示例，实际应用中可能需要更复杂的模型和优化过程。如果您有具体的数据集或需要进一步的帮助，请提供更多信息。
